"use strict";(globalThis.webpackChunkresium_docs=globalThis.webpackChunkresium_docs||[]).push([[5306],{7122:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"installation","title":"Installation","description":"Install cesium and resium:","source":"@site/docs/01-installation.md","sourceDirName":".","slug":"/installation","permalink":"/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/reearth/resium/edit/main/docs/docs/01-installation.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"installation","title":"Installation"},"sidebar":"docs","previous":{"title":"Home","permalink":"/"},"next":{"title":"Getting Started","permalink":"/getting_started"}}');var l=s(4848),a=s(8453);const t={id:"installation",title:"Installation"},c="Installation",d={},r=[{value:"1. create-react-app",id:"1-create-react-app",level:2},{value:"2. Next.js",id:"2-nextjs",level:2},{value:"2-1. Edit <code>next.config.js</code>",id:"2-1-edit-nextconfigjs",level:3},{value:"2-2. Set up script to copy Cesium files automatically",id:"2-2-set-up-script-to-copy-cesium-files-automatically",level:3},{value:"2-3: Implement your component",id:"2-3-implement-your-component",level:3},{value:"3. webpack: Copy whole Cesium files and load Cesium in HTML",id:"3-webpack-copy-whole-cesium-files-and-load-cesium-in-html",level:2},{value:"3-1. Install webpack plugins",id:"3-1-install-webpack-plugins",level:3},{value:"3-2. Add <code>cesium</code> to externals",id:"3-2-add-cesium-to-externals",level:3},{value:"3-3. Add plugins",id:"3-3-add-plugins",level:3},{value:"4. webpack: Copy only asset files and bundle Cesium normaly except assets",id:"4-webpack-copy-only-asset-files-and-bundle-cesium-normaly-except-assets",level:2},{value:"4-1. Install webpack plugins and loaders",id:"4-1-install-webpack-plugins-and-loaders",level:3},{value:"4-2. Add plugins",id:"4-2-add-plugins",level:3},{value:"4-3. Add loaders and load CSS file in the entry JS",id:"4-3-add-loaders-and-load-css-file-in-the-entry-js",level:3},{value:"4-4. Load CSS in your app",id:"4-4-load-css-in-your-app",level:3},{value:"5. Vite",id:"5-vite",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,l.jsxs)(n.p,{children:["Install ",(0,l.jsx)(n.code,{children:"cesium"})," and ",(0,l.jsx)(n.code,{children:"resium"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install --save cesium resium\n# OR\nyarn add cesium resium\n"})}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"For TypeScript users"}),": ",(0,l.jsx)(n.code,{children:"@types/cesium"})," is no longer needed because Resium supports Cesium official type definition."]})}),"\n",(0,l.jsx)(n.p,{children:"Then, to use Cesium in webpack environment, preparation is a bit more necessary, because Cesium includes many asset files."}),"\n",(0,l.jsx)(n.p,{children:"There are some choices. Choose one."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#1-create-react-app",children:"create-react-app"})," (not recommended)"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#2-nextjs",children:"Next.js"})}),"\n",(0,l.jsxs)(n.li,{children:["webpack","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#3-webpack-copy-whole-cesium-files-and-load-cesium-in-html",children:"Copy whole Cesium files and load Cesium in HTML"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#4-webpack-copy-only-asset-files-and-bundle-cesium-normaly-except-assets",children:"Copy only asset files and bundle Cesium normaly except assets"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#5-vite",children:"Vite"})," (",(0,l.jsx)(n.strong,{children:"\ud83d\ude80 recommended"}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"When you finish set up, you can import Cesium:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'import { Cartesian3 } from "cesium";\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Then advance to ",(0,l.jsx)(n.a,{href:"/getting_started",children:"Getting Started"}),"."]}),"\n",(0,l.jsx)(n.admonition,{type:"caution",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:'import Cesium from "cesium";'})," causes an error, as default is not exported from Cesium. Use ",(0,l.jsx)(n.code,{children:'import * as Cesium from "cesium";'}),"."]})}),"\n",(0,l.jsx)(n.h2,{id:"1-create-react-app",children:"1. create-react-app"}),"\n",(0,l.jsx)(n.admonition,{type:"caution",children:(0,l.jsxs)(n.p,{children:["Currently create-react-app is not developed actively and craco-cesium is not maintained. We recommend using ",(0,l.jsx)(n.a,{href:"#5-vite",children:"Vite"})," instead of."]})}),"\n",(0,l.jsxs)(n.p,{children:["If you are using create-react-app, ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/craco-cesium",children:"craco-cesium"})," is recommended."]}),"\n",(0,l.jsxs)(n.p,{children:["Refer to ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/craco-cesium#craco-cesium",children:"the documentation"})," and ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/resium/tree/main/examples/create-react-app",children:"example project"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"2-nextjs",children:"2. Next.js"}),"\n",(0,l.jsxs)(n.p,{children:["See also: ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/resium/tree/main/examples/next",children:"example project"})]}),"\n",(0,l.jsx)(n.p,{children:"The steps for initializing Next.js are not explained here. We will assume that your Next.js project already exists."}),"\n",(0,l.jsxs)(n.h3,{id:"2-1-edit-nextconfigjs",children:["2-1. Edit ",(0,l.jsx)(n.code,{children:"next.config.js"})]}),"\n",(0,l.jsx)(n.p,{children:"Add a webpack define pugin:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'const webpack = require("webpack");\n\nmodule.exports = {\n  reactStrictMode: true,\n  webpack: (config) => {\n    config.plugins.push(\n      new webpack.DefinePlugin({\n        CESIUM_BASE_URL: JSON.stringify("cesium"),\n      }),\n    );\n    return config;\n  },\n};\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-2-set-up-script-to-copy-cesium-files-automatically",children:"2-2. Set up script to copy Cesium files automatically"}),"\n",(0,l.jsxs)(n.p,{children:["Install ",(0,l.jsx)(n.code,{children:"symlink-dir"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install --save-dev symlink-dir\n# OR\nyarn add --dev symlink-dir\n"})}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"ln -s"})," commands is also OK, but I recommend ",(0,l.jsx)(n.code,{children:"symlink-dir"})," because it supports multi-platform."]})}),"\n",(0,l.jsxs)(n.p,{children:["Then edit ",(0,l.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",metastring:'title="package.json"',children:'{\n  "scripts": {\n    "postinstall": "symlink-dir node_modules/cesium/Build/Cesium public/cesium"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Finally execute postinstall scripts to create the symbolic link:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install\n# OR\nyarn\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Adding ",(0,l.jsx)(n.code,{children:"/public/cesium"})," to ",(0,l.jsx)(n.code,{children:".gitignore"})," is good:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-markup",metastring:'title=".gitignore"',children:"/public/cesium\n"})}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["Using ",(0,l.jsx)(n.code,{children:"copy-webpack-plugin"})," in ",(0,l.jsx)(n.code,{children:"next.config.js"})," does not work because the copied files won't be delivered correctly from the server."]})}),"\n",(0,l.jsx)(n.h3,{id:"2-3-implement-your-component",children:"2-3: Implement your component"}),"\n",(0,l.jsxs)(n.p,{children:["Cesium cannot be used in SSR, so components using Cesium should be separated from page components. Define your Cesium component in any location other than ",(0,l.jsx)(n.code,{children:"pages"})," directory."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-jsx",metastring:'title="components/Cesium.js"',children:'import { Viewer } from "resium";\n\nexport default function Cesium() {\n  return <Viewer full />;\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Then dynamically import components using Cesium with ",(0,l.jsx)(n.code,{children:"next/dynamic"}),". Don't forget ",(0,l.jsx)(n.code,{children:"{ ssr: false }"})," option. Also load Cesium CSS file with ",(0,l.jsx)(n.code,{children:"next/head"}),"."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-jsx",metastring:'title="pages/index.js"',children:'import Head from "next/head";\nimport dynamic from "next/dynamic";\n\nconst Cesium = dynamic(() => import("../components/Cesium"), { ssr: false });\n\nexport default function Home() {\n  return (\n    <>\n      <Head>\n        <link rel="stylesheet" href="cesium/Widgets/widgets.css" />\n      </Head>\n      <Cesium />\n    </>\n  );\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["If you want to import a TypeScript file (",(0,l.jsx)(n.code,{children:".tsx"}),"), ",(0,l.jsx)(n.code,{children:"() => import('../components/Cesium.tsx')"})," works instead."]}),"\n",(0,l.jsx)(n.p,{children:"That's all!"}),"\n",(0,l.jsx)(n.h2,{id:"3-webpack-copy-whole-cesium-files-and-load-cesium-in-html",children:"3. webpack: Copy whole Cesium files and load Cesium in HTML"}),"\n",(0,l.jsxs)(n.p,{children:["See also: ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/resium/tree/main/examples/webpack",children:"example project"})]}),"\n",(0,l.jsx)(n.h3,{id:"3-1-install-webpack-plugins",children:"3-1. Install webpack plugins"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install --save-dev copy-webpack-plugin html-webpack-plugin html-webpack-tags-plugin\n# OR\nyarn add copy-webpack-plugin html-webpack-plugin html-webpack-tags-plugin\n"})}),"\n",(0,l.jsx)(n.p,{children:"Then, edit your webpack configuration."}),"\n",(0,l.jsxs)(n.h3,{id:"3-2-add-cesium-to-externals",children:["3-2. Add ",(0,l.jsx)(n.code,{children:"cesium"})," to externals"]}),"\n",(0,l.jsx)(n.p,{children:"Cesium will be loaded in HTML. Notify it to webpack."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'{\n  externals: {\n    cesium: "Cesium";\n  }\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["When cesium is loaded, webpack uses ",(0,l.jsx)(n.code,{children:"window.Cesium"})," instead of loading source files."]}),"\n",(0,l.jsx)(n.h3,{id:"3-3-add-plugins",children:"3-3. Add plugins"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Copy whole Cesium files at build time with copy-webpack-plugin"}),"\n",(0,l.jsx)(n.li,{children:"Add tags to index.html to load JS and CSS with html-webpack-tags-plugin"}),"\n",(0,l.jsx)(n.li,{children:"Notify Cesium to its path with webpack define plugin"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'const webpack = require("webpack");\nconst HtmlPlugin = require("html-webpack-plugin");\nconst HtmlTagsPlugin = require("html-webpack-tags-plugin");\nconst CopyWebpackPlugin = require("copy-webpack-plugin");\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'{\n  plugins: [\n    // ...\n    new CopyWebpackPlugin({\n      patterns: [\n        {\n          from: "node_modules/cesium/Build/Cesium",\n          to: "cesium",\n        },\n      ],\n    }),\n    new HtmlPlugin({\n      template: "index.html",\n    }),\n    new HtmlTagsPlugin({\n      append: false,\n      tags: ["cesium/Widgets/widgets.css", "cesium/Cesium.js"],\n    }),\n    new webpack.DefinePlugin({\n      CESIUM_BASE_URL: JSON.stringify("/cesium"),\n    }),\n  ];\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Note: If ",(0,l.jsx)(n.code,{children:"publicPath"})," in webpack config is changed, ",(0,l.jsx)(n.code,{children:"CESIUM_BASE_URL"})," may have to be changed also."]}),"\n",(0,l.jsx)(n.h2,{id:"4-webpack-copy-only-asset-files-and-bundle-cesium-normaly-except-assets",children:"4. webpack: Copy only asset files and bundle Cesium normaly except assets"}),"\n",(0,l.jsx)(n.p,{children:"In this way, imported and used Cesium source codes are bundled to your app's source code with webpack."}),"\n",(0,l.jsxs)(n.p,{children:["See also: ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/resium/tree/main/examples/webpack2",children:"example project"})," and ",(0,l.jsx)(n.a,{href:"https://github.com/AnalyticalGraphicsInc/cesium-webpack-example",children:"Cesium official example"})]}),"\n",(0,l.jsx)(n.h3,{id:"4-1-install-webpack-plugins-and-loaders",children:"4-1. Install webpack plugins and loaders"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install --save-dev html-webpack-plugin copy-webpack-plugin css-loader style-loader url-loader\n# OR\nyarn add --dev html-webpack-plugin copy-webpack-plugin css-loader style-loader url-loader\n"})}),"\n",(0,l.jsx)(n.p,{children:"Then, edit your webpack configuration."}),"\n",(0,l.jsx)(n.h3,{id:"4-2-add-plugins",children:"4-2. Add plugins"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Copy only asset files at build time"}),"\n",(0,l.jsxs)(n.li,{children:["Cesium refers to ",(0,l.jsx)(n.code,{children:"CESIUM_BASE_URL"})," to find asset files"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'const webpack = require("webpack");\nconst HtmlPlugin = require("html-webpack-plugin");\nconst CopyWebpackPlugin = require("copy-webpack-plugin");\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'{\n  plugins: [\n    new HtmlPlugin({\n      template: "index.html",\n    }),\n    new CopyWebpackPlugin({\n      patterns: [\n        { from: "node_modules/cesium/Build/Cesium/Workers", to: "Workers" },\n        {\n          from: "node_modules/cesium/Build/Cesium/ThirdParty",\n          to: "ThirdParty",\n        },\n        { from: "node_modules/cesium/Build/Cesium/Assets", to: "Assets" },\n        { from: "node_modules/cesium/Build/Cesium/Widgets", to: "Widgets" },\n      ],\n    }),\n    new webpack.DefinePlugin({\n      CESIUM_BASE_URL: JSON.stringify(""),\n    }),\n  ];\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Note: If ",(0,l.jsx)(n.code,{children:"publicPath"})," in webpack config is changed, ",(0,l.jsx)(n.code,{children:"CESIUM_BASE_URL"})," may have to be changed also."]}),"\n",(0,l.jsx)(n.h3,{id:"4-3-add-loaders-and-load-css-file-in-the-entry-js",children:"4-3. Add loaders and load CSS file in the entry JS"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'{\n  module: {\n    rules: [\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: "babel-loader",\n      },\n      {\n        test: /\\.css$/,\n        use: ["style-loader", "css-loader"],\n      },\n      {\n        test: /\\.(png|gif|jpg|jpeg|svg|xml|json)$/,\n        use: ["url-loader"],\n      },\n    ];\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-4-load-css-in-your-app",children:"4-4. Load CSS in your app"}),"\n",(0,l.jsxs)(n.p,{children:["Add a link tag in head of your ",(0,l.jsx)(n.code,{children:"index.html"})," to load CSS:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-html",children:'<link rel="stylesheet" href="/Widgets/widgets.css" />\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Note: if you have changed ",(0,l.jsx)(n.code,{children:"CESIUM_BASE_URL"}),", you may also have to change this."]}),"\n",(0,l.jsxs)(n.p,{children:["Tips: Using ",(0,l.jsx)(n.code,{children:"html-webpack-tags-plugin"})," is also OK!"]}),"\n",(0,l.jsxs)(n.admonition,{type:"caution",children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/CesiumGS/cesium/issues/9212",children:"As reported on GitHub issues"}),", adding import statement to your entry JS (e.g. index.js) does not work for now:"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'import "cesium/Widgets/widgets.css";\n'})})]}),"\n",(0,l.jsx)(n.h2,{id:"5-vite",children:"5. Vite"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://vitejs.dev/",children:"Vite"})," is one of next generation JavaScript bundler. ",(0,l.jsx)(n.a,{href:"https://github.com/nshen/vite-plugin-cesium",children:"vite-plugin-cesium"})," is recommended to use Cesium with Vite."]}),"\n",(0,l.jsxs)(n.p,{children:["See also: ",(0,l.jsx)(n.a,{href:"https://github.com/reearth/resium/tree/main/examples/vite",children:"example project"})]}),"\n",(0,l.jsx)(n.p,{children:'Init a new vite project (select "react"):'}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm init vite example\n# OR\nyarn create vite example\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Then install Cesium, Resium, and ",(0,l.jsx)(n.a,{href:"https://github.com/",children:"vite-plugin-cesium"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install --save cesium resium\nnpm install --save-dev vite-plugin-cesium\n# OR\nyarn add cesium resium\nyarn add --dev vite-plugin-cesium\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Then edit ",(0,l.jsx)(n.code,{children:"vite.config.js"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'import { defineConfig } from "vite";\nimport react from "@vitejs/plugin-react";\nimport cesium from "vite-plugin-cesium";\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [react(), cesium()],\n});\n'})}),"\n",(0,l.jsx)(n.p,{children:"That's all!"})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(6540);const l={},a=i.createContext(l);function t(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);